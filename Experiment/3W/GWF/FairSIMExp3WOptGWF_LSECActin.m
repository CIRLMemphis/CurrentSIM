%% load the settings for this reconstruction
run("../OMX_LSEC_Actin_525nm/Exp3WLSECActinFullSetup.m");

%% load the data file
matFile = CIRLDataPath + "/FairSimData/OMX_LSEC_Actin_525nm.mat";
load(matFile);

%% Wiener parameter
wD = 0.05;

% lateral fractions
qn = [0, 1, -1, 2, -2]/2; % qn = (1:Nphi) - (Nphi+1)/2;

% decomposition matrix coefficients
cn = [1, 0.4, 0.4, 0.4, 0.4]; % cn = [1, 2/3, 2/3, 1/3, 1/3];

% input OTFs
load('FairSIMGreenHn_512_512_7_5.mat', 'Hn');

reconOb = OTFGWFCore(    g,  ...
                         Hn, ...
                         qn, ...
                         cn, ...
                         uc, ...
                         u, ...
                         phi, ...
                         offs, ...
                         theta, ...
                         wD, ...
                         dXY, dZ, ...
                         -1, 0, 0, [], 1, [], 0);

%% 
reconOb(reconOb < 0) = 0;
figure; imagesc(reconOb(513:end,513:end,5)); axis square;